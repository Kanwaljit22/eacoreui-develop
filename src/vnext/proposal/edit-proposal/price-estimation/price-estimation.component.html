
<ng-container *ngIf="vnextService.isRoadmapShown">
<div class="container-fluid " (window:resize)="onResize($event)" attr.page-id="{{dataIdConstantsService.pe_page_pePage}}">
    <div class="row align-items-center">
        <div class="col-12">
            <div *ngIf="proposalStoreService.proposalData?.scopeChangeInProgress && eaService.features.EDIT_EAID_REL"  class="alert alert--warning alert-dismissable mt-2">
                <span class="alert-icon d-flex">
                <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                </span>
               <span>{{'common.CUSTOMER_SCOPE_CHANGE_INPROGRESS_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
            </div>

            <div class="mb-3" *ngIf="proposalStoreService.mspInfo?.mspFlag && eaService.features?.PARTNER_SUPER_USER_REL">
                <div class="d-flex justify-content-between align-items-center info-alert-blue bl-3">
                    <span class="d-flex align-items-center">
                        <span class="icon-msg-Info mr-3"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                        <span class="pos-rel t-1">{{'price-estimation.DEFAULT_EA_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                    </span>
                </div>
            </div>

            <div class="alert alert--info alert-dismissable justify-content-between mt-2 mb-3" *ngIf="(proposalStoreService.proposalData?.scopeChanged && eaService.features.EDIT_EAID_REL)">
                <div class="d-flex align-items-center">
                <span class="alert-icon">
                    <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span
                            class="path3"></span></span>
                </span>
                <span>{{'common.CUSTOMER_SCOPE_CHANGE_UPDATE_REVALIDATED_INPROGRESS' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>
            </div>
            <div class="alert alert--info alert-dismissable justify-content-between mt-2 mb-3" *ngIf="isChangeSubFlow && showChangeSubMsg && !proposalStoreService.proposalData?.dealInfo?.subscriptionUpgradeDeal">
                <div class="d-flex align-items-center">
                <span class="alert-icon">
                    <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span
                            class="path3"></span></span>
                </span>
                <span>{{'price-estimation.CHANGE_SUB_INFO_MSG_1' | localizationPipe : localizationService.localizedkeySet.size}}<br>{{'price-estimation.CHANGE_SUB_INFO_MSG_2' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>
                <span class="icon-close-btn" attr.action-id="{{dataIdConstantsService.pe_button_closeInfoMsg}}" (click)="hideChangeSubMsg()"></span>
            </div>
            <ng-container>
                <div *ngIf="proposalStoreService.proposalData?.dealInfo?.subscriptionUpgradeDeal && proposalStoreService.proposalData.subRefId" class="alert alert--info alert-dismissable mt-3">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.UPGRADE_ONLY_AVAILABLE_FOR' | localizationPipe : localizationService.localizedkeySet.size}} <a href="javascript:void(0);" (click)="routeToUrl(proposalStoreService.proposalData.subRefId)">{{proposalStoreService.proposalData.subRefId}}. </a> <span>{{'price-estimation.INORDER_TO_BUY_NEW_SUITES' | localizationPipe : localizationService.localizedkeySet.size}}</span></span>
                </div>
                <div *ngIf="proposalStoreService.proposalData?.dealInfo?.subscriptionUpgradeDeal && !showUpgradeSummary() && !eaService.features?.CROSS_SUITE_MIGRATION_REL" class="alert alert--info alert-dismissable">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.NO_SUITES_UPGRADED_PROP_SUBMISSION_BLOCKED_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>  
            </ng-container>

            <!-- info message to show when splunk suites are added on the proposal -->
            <div class="mt-2" *ngIf="eaService.features.SPLUNK_SUITE_REL && showSplunkMessage && proposalStoreService.proposalData?.isSplunkSuitesAdded">
                <div class="d-flex justify-content-between align-items-center info-alert-blue bl-3">
                    <span class="d-flex align-items-center">
                        <span class="icon-msg-Info mr-3"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                        <span class="pos-rel t-1">{{'common.SPLUNK_ADDED_TO_PROPOSAL_ENGAGE_SPLUNK_RSM_SUPPORT_MESSAGE_1' | localizationPipe : localizationService.localizedkeySet.size}}<a href="mailto:clo-ea-splunk-support@cisco.com">{{'common.CISCO_SUPPORT' | localizationPipe : localizationService.localizedkeySet.size}}</a>{{'common.SPLUNK_ADDED_TO_PROPOSAL_ENGAGE_SPLUNK_RSM_SUPPORT_MESSAGE_2' | localizationPipe : localizationService.localizedkeySet.size}} </span>
                    </span>
                    <a href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_closeInfoMsg}}" (click)='showSplunkMessage = false;' class="lh-1"><span class="icon-close-btn"></span></a>
                </div>
            </div>


            <!-- warning message when partner accessing sfdc deal with locc unsigned and cx not added yet -->
            <div *ngIf="!proposalStoreService.isReadOnly && selectedEnrollmentArray.length && proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned" class="alert alert--warning alert-dismissable mt-2">
                <span class="alert-icon d-flex">
                <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                </span>
               <span>{{'price-estimation.LOCC_NOT_SIGNED_TO_ADD_SERVICES_SFDC_DEAL' | localizationPipe : localizationService.localizedkeySet.size}}</span>
            </div>
            <div class="alert alert--warning mt-3 strategic-info" *ngIf="isStrategicOffer">
                <span class="alert-icon">
                    <img src="../../../../assets/icons/strategic-offers-new.svg" />
                </span>
                <span><strong>{{'common.STRATEGIC_OFFERS' | localizationPipe : localizationService.localizedkeySet.size}}</strong> {{'price-estimation.YOU_MAY_QUALIFY_FOR_SO' | localizationPipe : localizationService.localizedkeySet.size}} <a href="javascript:void(0);" (click)="openOfferModal()" [ngClass]="{'disabled': proposalStoreService.projectStatus !== 'COMPLETE' || proposalStoreService.isReadOnly }" attr.action-id="{{dataIdConstantsService.pe_link_strategicOffer}}">{{'price-estimation.EXPLORE_STRATEGIC_OFFERS' | localizationPipe : localizationService.localizedkeySet.size}}</a></span>
            </div>
        </div>
        
        <div class="col-12">
            <div id="filter-area" class="vNext">
                <div class="row align-items-center">
                    <div class="col-5 my-2">
                        <h2>{{'common.PRICE_ESTIMATION' | localizationPipe : localizationService.localizedkeySet.size}}</h2>
                    </div>
                    <div class="col-7">
                        <ul class="inline-listing justify-content-end border-right-li">
                            <li *ngIf="isStrategicOffer">
                                <button class="btn btn-primary" (click)="openOfferModal()" [ngClass]="{'disabled': proposalStoreService.projectStatus !== 'COMPLETE' || proposalStoreService.isReadOnly }" attr.action-id="{{dataIdConstantsService.pe_button_strategicOffer}}">
                                    {{'common.STRATEGIC_OFFERS' | localizationPipe : localizationService.localizedkeySet.size}} 
                                </button>
                            </li>
                           
                            <!-- create TCO button-->
                        <li *ngIf="eaService.features.TCO_REL && proposalStoreService.proposalData.tcoEligible">
                            <button type="button"
                                *ngIf='enableContinue && !priceEstimateStoreService.enableRecalculateAll && !proposalStoreService.rsdDueCurrDate && !errorMessage && !priceEstimateStoreService.displayIbPullMsg && !eaStoreService.isValidationUI && !(proposalStoreService.proposalData?.createdBeforeTco && proposalStoreService.proposalData?.status !== "IN_PROGRESS") ; else disableTCO'
                                (click)='getTcoId()' class="btn btn-secondary" attr.action-id="{{dataIdConstantsService.pe_button_tco}}" id="{{elementIdConstantsService.PRICE_ESTIMATION_TCO_BUTTON}}">{{'common.TCO_BUTTON_LABEL' | localizationPipe : localizationService.localizedkeySet.size}}</button>
                            <ng-template #disableTCO>
                                <button type="button" class="btn btn-secondary tco-button disabled" attr.action-id="{{dataIdConstantsService.pe_button_tco_disabled}}" ngbTooltip=" {{(proposalStoreService.proposalData?.createdBeforeTco && proposalStoreService.proposalData?.status !== 'IN_PROGRESS') ? ('price-estimation.TCO_DISABLED_TOOLTIP_MSG_COMPLETED' | localizationPipe : localizationService.localizedkeySet.size) : ('price-estimation.TCO_DISABLED_TOOLTIP_MSG' | localizationPipe : localizationService.localizedkeySet.size)}}" container="body" placement="top">{{'common.TCO_BUTTON_LABEL' | localizationPipe : localizationService.localizedkeySet.size}}</button>
                            </ng-template>
                        </li>

                            <li class="dropdown" *ngIf="!eaStoreService.isValidationUI" (clickOutside)="showMoreActions = false;">	
                                <a href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_dropdown_moreAction}}" (click)="showMoreActions = true;" id="{{elementIdConstantsService.Priceestimate_Proposal_Actions}}">{{'price-estimation.PROPOSAL_ACTIONS' | localizationPipe : localizationService.localizedkeySet.size}} <span class="i-vNext-arrow-down-heavy position-relative top-1"></span></a>
                                <ul class="dropdown-menu top-35" [class.show]="showMoreActions">	
                                   
                                    <li>
                                        <a #downloadZipLink [hidden]="true"></a>
                                        <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_DOWNLOAD_PRICE_ESTIMATE}}" attr.action-id="{{dataIdConstantsService.pe_link_downlaod_pe}}" class="dropdown-item" (click)="downloadExcel()">
                                            <span class="i-vNext-download listing-icon"></span>
                                            {{'common.DOWNLOAD_PRICE_ESTIMATE' | localizationPipe : localizationService.localizedkeySet.size}}	
                                        </a>
                                    </li>
                                    <li>	
                                        <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_REQUEST_DOCUMENT}}" class="dropdown-item"  attr.action-id="{{dataIdConstantsService.pe_link_requestDoc}}"  (click)="requestDocuments()">	
                                            <span class="i-vNext-request-document listing-icon"></span>		
                                            {{'price-estimation.REQUEST_DOCUMENT' | localizationPipe : localizationService.localizedkeySet.size}}	
                                        </a>	
                                    </li>	
                                    <li>	
                                        <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_PROPSAL_LIST}}" attr.action-id="{{dataIdConstantsService.pe_link_proposalList}}" class="dropdown-item" (click)="viewProposalList()">	
                                            <span class="i-vNext-proposal-list-grey listing-icon"></span> 	
                                            {{'common.PROPSAL_LIST' | localizationPipe : localizationService.localizedkeySet.size}}	
                                        </a>	
                                    </li> 
                                    <li *ngIf="(!proposalStoreService.isReadOnly || (proposalStoreService.proposalData.status === 'IN_PROGRESS' && (eaService.isResellerLoggedIn || eaService.isResellerOpty))) && selectedEnrollmentArray.length && enableEngageSupportTeam()">	
                                        <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_ENGAGE_SUPPORT_TEAM}}" class="dropdown-item" attr.action-id="{{dataIdConstantsService.pe_link_engageSupport}}" (click)="engageSupportTeam(); showMoreActions = false;">
                                            <span class="i-vNext-support-contact listing-icon"></span>
                                            {{'common.ENGAGE_SUPPORT_TEAM' | localizationPipe : localizationService.localizedkeySet.size}}
                                        </a>	
                                    </li>
                                    <li *ngIf="proposalStoreService.projectStatus === 'COMPLETE'">	
                                        <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_MANAGE_TEAM}}"  attr.action-id="{{dataIdConstantsService.pe_link_manageTeam}}" class="dropdown-item" (click)="openManageTeam()" *ngIf="proposalStoreService.proposalEditAccess || projectStoreService.projectEditAccess || (projectStoreService.projectManageTeamAccess && proposalStoreService.isPartnerAccessingSfdcDeal); else disableManageTeam">	
                                            <span class="i-vNext-manage-team listing-icon"></span> 	                                            
                                            {{'common.MANAGE_TEAM' | localizationPipe : localizationService.localizedkeySet.size}}	 
                                        </a>	
                                        <ng-template #disableManageTeam>
                                            <a href="javascript:void(0);" class="dropdown-item disabled" attr.action-id="{{dataIdConstantsService.pe_link_manageTeamDisabled}}">	
                                                <span class="i-vNext-manage-team listing-icon"></span> 	                                            
                                                {{'common.MANAGE_TEAM' | localizationPipe : localizationService.localizedkeySet.size}}	 
                                            </a>
                                        </ng-template>
                                    </li>
                                <!-- <li *ngIf="isCxPresent && !proposalStoreService.isReadOnly" [ngClass]="{'disabled': !priceEstimateStoreService.eamsDeliveryObj?.partnerDeliveryEligible}">	
                                    <a href="javascript:void(0);" class="dropdown-item" (click)="openEAMS(); showMoreActions = false;">	
                                        <span class="listing-icon i-vNext-questionnaire"></span>
                                        EAMS Delivery	
                                    </a>	
                                </li>	  -->
                                </ul>	
                            </li>

                            <li attr.action-id="{{dataIdConstantsService.pe_button_viewEligibilityDetails}}" (click)='viewEligibilityDetails()' *ngIf="!isUpgradeFlow">
                                <a href="javascript:void(0);" class="position-relative">
                                    <span class="prog-elig-wrap progress-status" [ngClass]="{'progress-status':!isProgramEligible,'completed-status':isProgramEligible}" placement="bottom" ngbTooltip="Click for more details">
                                        <span id="{{elementIdConstantsService.PE_PROGRAM_ELIGIBILITY}}" class="title" attr.data-id="{{dataIdConstantsService.pe_label_programEligibility}}">{{'common.PROGRAM_ELIGIBILITY' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                                        <span class="value" *ngIf="isProgramEligible;else programEligibilityCheck" attr.data-id="{{dataIdConstantsService.pe_label_eligible}}"> {{'price-estimation.ELIGIBLE' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                                        <ng-template #programEligibilityCheck>
                                            <span class="value" attr.data-id="{{dataIdConstantsService.pe_label_notEligible}}">{{'price-estimation.NOT_ELIGIBLE' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                                        </ng-template>                                 
                                    </span>
                                </a>
                            </li>



                            <li attr.action-id="eaService.features.CROSS_SUITE_MIGRATION_REL ? {{dataIdConstantsService.pe_button_viewMigrationUpgradeSummary}} : {{dataIdConstantsService.pe_button_viewUpgradeSummary}}" (click)='openUpgradeSummary()' *ngIf="showUpgradeSummary() && isUpgradeFlow">
                                <a href="javascript:void(0);" class="position-relative">
                                    <span class="prog-elig-wrap progress-status" [ngClass]="{'progress-status':!isProgramEligible,'completed-status':isProgramEligible}" placement="bottom" ngbTooltip="Click for more details">
                                        <span class="i-vNext-proposal-list-grey listing-icon"></span>
                                        <span class="upgrade-summary-title" *ngIf="!eaService.features.CROSS_SUITE_MIGRATION_REL">{{'price-estimation.UPGRADE_SUMMARY' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                                        <span class="upgrade-summary-title" id="{{elementIdConstantsService.PE_MIGRATION_UPGRADE_SUMMARY}}"  *ngIf="eaService.features.CROSS_SUITE_MIGRATION_REL">{{'common.MIGRATION_UPGRADE_SUMMARY' | localizationPipe : localizationService.localizedkeySet.size}}</span>                                  
                                    </span>
                                </a>
                            </li>

                        </ul>
                        <div class="pe-absolute-button" [ngClass]="{'changeSub': isChangeSubFlow && showChangeSubMsg, 'upgrade': isUpgradeFlow && !showUpgradeSummary(), 'strategicOffer': isStrategicOffer, 'mt-3':eaStoreService.isValidationUI,'notLocc': !proposalStoreService.isReadOnly && selectedEnrollmentArray.length && proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned, 'migrate-reason': eaService.features?.CROSS_SUITE_MIGRATION_REL && eaService.isUpgradeFlow && displayMigrationReasonMsg, 'splunkSuitePresent': eaService.features.SPLUNK_SUITE_REL && showSplunkMessage && proposalStoreService.proposalData?.isSplunkSuitesAdded}">
                        <!-- <button type="button" class="btn btn-secondary mr-3">Exit</button> -->
                        <button *ngIf="eaStoreService.isValidationUI" attr.action-id="{{dataIdConstantsService.pe_button_peBackToOWB}}"  type="button" class="btn btn-primary mr-1" (click)="navigateToOWB()"> {{'price-estimation.BACK_TO_OWB' | localizationPipe : localizationService.localizedkeySet.size}}</button>
                        <button attr.action-id="{{dataIdConstantsService.pe_button_peContinue}}" type="button" *ngIf='enableContinue && !priceEstimateStoreService.enableRecalculateAll && !proposalStoreService.rsdDueCurrDate && !errorMessage && !priceEstimateStoreService.displayIbPullMsg && !eaStoreService.isValidationUI ; else disableContinue' (click)='continue()' id="{{elementIdConstantsService.PE_CONTINUE}}" class="btn btn-primary">{{'common.CONTINUE' | localizationPipe : localizationService.localizedkeySet.size}}</button>
                        <ng-template #disableContinue>
                                    <button type="button" attr.action-id="{{dataIdConstantsService.pe_button_peContinueDisabled}}" class="btn btn-primary disabled">{{'common.CONTINUE' | localizationPipe : localizationService.localizedkeySet.size}}</button>
                        </ng-template>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End of Filter Row -->
</div>
<!-- End of PageTitle Area -->

<section class="">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div *ngIf="proposalStoreService.rsdDueCurrDate" class="alert alert--danger alert-dismissable mb-2">
                    <span class="alert-icon">
                        <span class="icon-msg-error"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'common.RSD_CANNOT_PAST_DATE' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>
                 <div *ngIf="eaService.features?.RENEWAL_SEPT_REL && proposalStoreService.proposalData?.renewalInfo?.id && isEnrollmentLocked" class="alert alert--danger alert-dismissable mb-2">
                    <span class="alert-icon">
                        <span class="icon-msg-error"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.RENEWAL_POR_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div> 
                <div *ngIf="eaService.features.CROSS_SUITE_MIGRATION_REL && isUpgradeFlow && proposalStoreService.proposalData?.allUpgradeMigrationRestored && !proposalStoreService.isReadOnly" class="alert alert--warning alert-dismissable mb-2">
                    <span class="alert-icon d-flex">
                    <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                   <span>{{'price-estimation.UPGRADE_MIGRATION_RESTORED_FOR_PROPOSAL_MESSAGE' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>
                <div *ngIf="displayCxManageTeamMsg && !proposalStoreService.isReadOnly" class="alert alert--warning alert-dismissable mb-2">
                    <span class="alert-icon d-flex">
                    <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                   <span>{{'price-estimation.ENTER_SERVICE_SPECIALIST_AND_DEALS_ASSURER' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>
                <div *ngIf="proposalStoreService.projectStatus !== 'COMPLETE' && !eaStoreService.isValidationUI" class="alert alert--warning alert-dismissable mb-2">
                        <span class="alert-icon d-flex">
                        <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                        </span>
                       <span>{{'price-estimation.PROJECT_EDIT_MODE' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                    </div>
                 <div *ngIf="proposalStoreService.proposalData?.originalProposalId && isShowCopiedPropMsg && (!eaService.features?.PARTNER_SUPER_USER_REL || !proposalStoreService.proposalData?.cloned)" class="alert alert--info alert-dismissable">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'common.COPIED_PROPOSAL' | localizationPipe : localizationService.localizedkeySet.size}} <a class="d-inline" href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_openOriginalProposal}}" (click)="proposalService.openOriginalProposal()">{{'common.HERE' | localizationPipe : localizationService.localizedkeySet.size}}</a> {{'common.ORIGINAL_PROPOSAL' | localizationPipe : localizationService.localizedkeySet.size}} ({{proposalStoreService.proposalData?.originalProposalId}})</span>
                </div> 

                <div *ngIf="proposalStoreService.proposalData?.originalProposalId && eaService.features?.PARTNER_SUPER_USER_REL && proposalStoreService.proposalData?.cloned" class="alert alert--info alert-dismissable">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'common.CLONED_PROPOSAL_NEW_MSG' | localizationPipe : localizationService.localizedkeySet.size}} <a class="d-inline" href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_openOriginalProposal}}" (click)="proposalService.openOriginalProposal()">{{'common.ORIGINAL_PROPOSAL_TEXT' | localizationPipe : localizationService.localizedkeySet.size}}</a></span>
                </div>

                <!--Start Disti flow for sept release-->
                <div *ngIf="eaService.isDistiLoggedIn && eaService.isDistiOpty" class="alert alert--info alert-dismissable">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.DISTI_INVITE_TO_2T_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div> 
                <div *ngIf="priceEstimateStoreService.isHybridEnrollmentSelected" class="alert alert--info alert-dismissable">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.HYBRID_PORTFOLIO_ADDED_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>
                <div *ngIf="eaService.isResellerOpty && eaService.isResellerLoggedIn" class="alert alert--info alert-dismissable">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.RESELLER_RO_MODE_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div> 
                <!--End Disti flow for sept release-->
                <div *ngIf="displayPAMsg" class="alert alert--info alert-dismissable">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'common.PLEASE_VALIDATE_YOUR_TCV_UPDATED' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>
                
                <div class="alert alert--info alert-dismissable"  *ngIf="eaService.isDistiLoggedIn && eaService.isResellerOpty && !proposalStoreService.proposalData.sharedWithDistributor">
                    <span class="alert-icon">
                        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.PROPSAL_LOCKED_AS_2T_ACCESSING_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>

                <div class="alert alert--success alert-dismissable" *ngIf="eaService.isDistiLoggedIn && eaService.isResellerOpty && proposalStoreService.proposalData.sharedWithDistributor">
                    <span class="alert-icon">
                        <span class="icon-done1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                    </span>
                    <span>{{'price-estimation.RESELLER_TRANSFERRED_TO_DISTI_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                </div>

        
            </div>
        </div>
        <!-- End of Eligibility Alert -->
        <ng-container  *ngIf="proposalStoreService.proposalData?.enrollments?.length ">
        <!-- <div class="row">
            <div class="col-12 text-center">
                <h5 class="heading--h5">{{localizationService.getLocalizedString('price-estimation.SELECT_PORTFOLIO')}}</h5>
            </div>
        </div> -->
        
            <app-enrollment (editEnrollmentEvent) = "openEditEnrollment($event)" (enrollSelectionEvent) = "selectEnrollment($event)"  (displayEnrollmentData)="displayGridForEnrollment($event, true)" [enrollmentData] = "proposalStoreService.proposalData.enrollments" [isChangeSubFlow]="isChangeSubFlow"></app-enrollment>
        
        <!-- End of Enrollment Row -->

    </ng-container>
    <div class="alert alert--warning alert-dismissable mb-2 mt-2" *ngIf="eaService.features?.CROSS_SUITE_MIGRATION_REL && eaService.isUpgradeFlow && displayMigrationReasonMsg">
            <span class="alert-icon d-flex">
            <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
            </span>
        <span>{{'price-estimation.FEW_MIGRATE_NOT_ELIGIBLE_WARNING' | localizationPipe : localizationService.localizedkeySet.size}}</span><span (click)="showUnavailbaleMigrateReasons()" class="mt-1 ml-2" attr.action-id="{{dataIdConstantsService.pe_link_showUnavailbaleMigrateReasons}}"><a href="javascript:void(0);">{{'common.CLICK_HERE' | localizationPipe : localizationService.localizedkeySet.size}}</a></span>
        </div>
    </div>
</section>

<section class="vNext border-w-t15 ">
    <div class="container-fluid">            
        <ng-container *ngIf='selectedEnrollmentArray.length'>
            <div class="row align-items-center vNext">
                <div class="d-flex align-items-center"  [ngClass]="{'col-12 b-bottom': eaService.features.IB_OPTIMIZATION, 'col-3': isDnxSuiteAdded && !eaService.features.IB_OPTIMIZATION, 'col-4': !isDnxSuiteAdded && !eaService.features.IB_OPTIMIZATION}">
                    <h5 class="heading--h5" *ngIf="!priceEstimateStoreService.viewAllSelected"><strong>{{'price-estimation.CONFIGURING' | localizationPipe : localizationService.localizedkeySet.size}}</strong> {{priceEstimateStoreService.selectedEnrollment?.name}}</h5>
                    <h5 class="heading--h5" *ngIf="priceEstimateStoreService.viewAllSelected">{{'price-estimation.ALL_PORTFOLIO' | localizationPipe : localizationService.localizedkeySet.size}}</h5>
                    
                        <!-- Add class "disable" to make it read only -->
                        <div class="vNext-switch" *ngIf='selectedEnrollmentArray.length > 1'>
                            <span class="switch-text mr-2" >{{'price-estimation.SHOW_ALL_PORTFOLIOS' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                            <label class="switch-button" >
                                <input type="checkbox" attr.data-id="{{dataIdConstantsService.pe_checkbox_toggleAllPortfolio}}" (click)="toggleAllPortfolio();" [checked]='togglePortfolio'>
                                <span class="slider round"></span>
                            </label>
                        </div>
                </div>
                
                <div class="" [ngClass]="{'col-12 mb-2': eaService.features.IB_OPTIMIZATION, 'col-9': isDnxSuiteAdded && !eaService.features.IB_OPTIMIZATION, 'col-8': !isDnxSuiteAdded && !eaService.features.IB_OPTIMIZATION}">
                    <ul class="inline-listing justify-content-end border-right-li mt-2">
                        <!--<li (click)="dialDown()">
                            <a href="javascript:void(0);">
                                <span class="listing-icon"><img src="assets/images/icons/apply-discount.svg"></span> 
                                Dial Down Ramp
                            </a>
                        </li> -->
                        <li *ngIf="!eaStoreService.isValidationUI && isDnxSuiteAdded && !priceEstimateStoreService.viewAllSelected && priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate" class="position-relative ib-repull-date" >
                            <span *ngIf="!eaService.features.IB_OPTIMIZATION">{{'price-estimation.associated-services-grid.LAST_IB_REPROCESS_DATE' | localizationPipe : localizationService.localizedkeySet.size}}{{priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate | date:"dd MMM yyyy"}} {{priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate | date:"HH:mm aa"}}</span>
                            <span *ngIf="eaService.features.IB_OPTIMIZATION">{{'price-estimation.associated-services-grid.LAST_IB_UPDATE_DATE' | localizationPipe : localizationService.localizedkeySet.size}}{{priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate | date:"dd MMM yyyy"}} {{priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate | date:"HH:mm aa"}}</span>
                        </li>
                        <li *ngIf="eaStoreService.ibRepullFeatureFlag && !eaStoreService.isValidationUI && isDnxSuiteAdded && !eaService.features.IB_OPTIMIZATION" class="position-relative" >
                            <a href="javascript:void(0);" class="disabled" *ngIf="priceEstimateStoreService.displayReprocessIB || priceEstimateStoreService.viewAllSelected || proposalStoreService.isReadOnly || (proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned); else enableReprocesIbAssessment" attr.action-id="{{dataIdConstantsService.servicesGrid_link_reProcessIb_disabled}}">
                                <span class="i-vNext-scanning mr-2"></span>{{'price-estimation.associated-services-grid.REPROCESS_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}
                            </a>
                            <ng-template #enableReprocesIbAssessment>
                                <a href="javascript:void(0);" (click)="reProcessIbPull()" attr.action-id="{{dataIdConstantsService.servicesGrid_link_reProcessIb}}"><span class="i-vNext-scanning mr-2"></span>{{'price-estimation.associated-services-grid.REPROCESS_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                                <div class="ib-popup" *ngIf="ibQuantityPopup">
                                    <button type="button" class="icon-close-btn" (click)="ibQuantityPopup = false;" attr.action-id="{{dataIdConstantsService.servicesGrid_button_reProcessIbPullMsg}}"></button>
                                    <h5 class="mb-2"><b>{{'price-estimation.associated-services-grid.REPROCESS_LIMIT_REACHED' | localizationPipe : localizationService.localizedkeySet.size}}</b></h5>
                                    <p>{{'price-estimation.associated-services-grid.REPROCESS_TRY_AGAIN' | localizationPipe : localizationService.localizedkeySet.size}}</p>
                                    <p><b>{{nextIbPullTimeStamp[0]}}</b>{{'common.HOUR' | localizationPipe : localizationService.localizedkeySet.size}}<b>{{nextIbPullTimeStamp[1]}}</b>{{'common.MINUTES' | localizationPipe : localizationService.localizedkeySet.size}}</p>
                                </div>
                            </ng-template>
                        </li>
                        <li *ngIf="!eaStoreService.isValidationUI && isDnxSuiteAdded">
                            <a href="javascript:void(0);" class="view-edit-details disabled" *ngIf="priceEstimateStoreService.displayReprocessIB || priceEstimateStoreService.viewAllSelected || priceEstimateStoreService.displayIbPullMsg || (eaService.isUpgradeFlow && !priceEstimateStoreService.selectedCxEnrollment?.ibAssementRequiredForCxUpgradeType) || (proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned) || (!eaService.features.IB_OPTIMIZATION || (eaService.features.IB_OPTIMIZATION && (proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag || proposalStoreService.proposalData?.syncStatus?.cxEditFlag))) || (eaService.features?.PARTNER_SUPER_USER_REL && proposalStoreService.isPartnerAccessingSfdcDeal && (eaStoreService.userInfo?.superUser && eaStoreService.userInfo?.superUser === constantsService.PARTNER_RO_SUPER_USER) ); else enableHwSupport" #viewAndEditIbDisableMsgTooltip="ngbTooltip" [ngbTooltip]="(eaService.features.IB_OPTIMIZATION && (proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag || proposalStoreService.proposalData?.syncStatus?.cxEditFlag)) ?  viewAndEditDisableTooltip: ''" container="body" placement="top" attr.action-id="{{dataIdConstantsService.servicesGrid_link_viewAndEditHardwareSupport_disabled}}">
                                <span class="listing-icon i-vNext-discount disabled"></span>{{'common.HARDWARE_SUPPORT_DETAILS' | localizationPipe : localizationService.localizedkeySet.size}}
                            </a>
                            <ng-template #viewAndEditDisableTooltip>
                                {{'price-estimation.associated-services-grid.VIEW_EDIT_DISABLE_TOOLTOP_MSG' | localizationPipe : localizationService.localizedkeySet.size}}
                            </ng-template>
                            <ng-template #enableHwSupport>
                                <a href="javascript:void(0);" (click)='viewAndEditHardwareSupport()' attr.action-id="{{dataIdConstantsService.servicesGrid_link_viewAndEditHardwareSupport}}">
                                    <span class="listing-icon i-vNext-discount"></span>{{'common.HARDWARE_SUPPORT_DETAILS' | localizationPipe : localizationService.localizedkeySet.size}}
                                </a>
                            </ng-template>
                        </li>
                         <li *ngIf="priceEstimateStoreService.selectedEnrollment?.id !== 6">
                            <ng-container *ngIf="!isUpgradeFlow">
                                <a href="javascript:void();" attr.action-id="{{dataIdConstantsService.pe_link_addMoreSuitesDisabled}}" *ngIf="priceEstimateStoreService.viewAllSelected || proposalStoreService.isReadOnly; else enableAddMoreSuites" class="disabled"><span class="listing-icon i-vNext-add-heavy"></span>{{'price-estimation.ADD_SUITE_SERVICE' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                            <ng-template #enableAddMoreSuites>
                                <a href="javascript:void();" id="{{elementIdConstantsService.PE_ADD_SUITE_SERVICE}}" attr.action-id="{{dataIdConstantsService.pe_link_addMoreSuites}}" (click)="addMoreSuites()"><span class="listing-icon i-vNext-add-heavy"></span>{{'price-estimation.ADD_SUITE_SERVICE' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                            </ng-template>
                            </ng-container>
                            <ng-container *ngIf="isUpgradeFlow">
                            <ng-container *ngIf="eaService.features?.CROSS_SUITE_MIGRATION_REL">
                                <a href="javascript:void();" attr.action-id="{{dataIdConstantsService.pe_link_upgradeMigrateSuitesDisabled}}" *ngIf="priceEstimateStoreService.viewAllSelected || proposalStoreService.isReadOnly; else enableUpgradeSuites" class="disabled"><span class="listing-icon i-vNext-add-heavy"></span>{{'price-estimation.UPGRADE_MIGRATE_SUITE' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                            <ng-template #enableUpgradeSuites>
                                <a href="javascript:void();" id="{{elementIdConstantsService.PE_ADD_SUITE_SERVICE}}" attr.action-id="{{dataIdConstantsService.pe_link_upgradeMigrateSuites}}" (click)="addMoreSuites()"><span class="listing-icon i-vNext-add-heavy"></span>{{'price-estimation.UPGRADE_MIGRATE_SUITE' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                            </ng-template>
                            </ng-container>
                            <ng-container *ngIf="!eaService.features?.CROSS_SUITE_MIGRATION_REL">
                                <a href="javascript:void();" attr.action-id="{{dataIdConstantsService.pe_link_upgradeSuitesDisabled}}" *ngIf="priceEstimateStoreService.viewAllSelected || proposalStoreService.isReadOnly; else enableUpgradeSuites" class="disabled"><span class="listing-icon i-vNext-add-heavy"></span>{{'price-estimation.UPGRADE_SUITE_SERVICE' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                            <ng-template #enableUpgradeSuites>
                                <a href="javascript:void();" attr.action-id="{{dataIdConstantsService.pe_link_upgradeSuites}}" (click)="addMoreSuites()"><span class="listing-icon i-vNext-add-heavy"></span>{{'price-estimation.UPGRADE_SUITE_SERVICE' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                            </ng-template>
                            </ng-container>
                            </ng-container>
                        </li>

                        <li *ngIf="priceEstimateStoreService.selectedEnrollment?.enrolled && !proposalStoreService.proposalData?.dealInfo?.subscriptionUpgradeDeal">	
                            <a href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_applyDiscountDisabled}}" *ngIf="!proposalStoreService.proposalData.enrollments?.length || priceEstimateStoreService.enableRecalculateAll || priceEstimateStoreService.viewAllSelected || proposalStoreService.isReadOnly || (eaService.isResellerLoggedIn) || proposalStoreService.isPartnerAccessingSfdcDeal; else enableApplyDiscount" class="disabled">	
                                <span class="listing-icon i-vNext-multi-discount"></span> 	
                                {{'common.CHANGE_DISCOUNT' | localizationPipe : localizationService.localizedkeySet.size}}	 
                            </a>
                            <ng-template #enableApplyDiscount>
                                <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_CHANGE_DISCOUNT}}" attr.action-id="{{dataIdConstantsService.pe_link_applyDiscount}}" (click)="applyDiscount();">	
                                    <span class="listing-icon i-vNext-multi-discount"></span> 	
                                    {{'common.CHANGE_DISCOUNT' | localizationPipe : localizationService.localizedkeySet.size}}	 
                                </a>
                            </ng-template>	
                        </li>
                        <li *ngIf="(((priceEstimateStoreService.selectedEnrollment?.id === 1 || priceEstimateStoreService.selectedEnrollment?.id === 3) && priceEstimateStoreService.totalDesiredQtyForEnrollment) || priceEstimateStoreService.selectedEnrollment?.id === 4 || priceEstimateStoreService.selectedEnrollment?.id === 6) && (!proposalStoreService.proposalData.dealInfo?.subscriptionUpgradeDeal || (proposalStoreService.proposalData.dealInfo?.subscriptionUpgradeDeal && eaService.features.CROSS_SUITE_MIGRATION_REL && priceEstimateService.isMigrationSuitesPresentInEnrollment))">
                            <a href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_openPurchaseAdjDisabled}}" class="disabled"  *ngIf="!proposalStoreService.proposalData.enrollments?.length || priceEstimateStoreService.enableRecalculateAll || priceEstimateStoreService.viewAllSelected || proposalStoreService.isReadOnly || proposalStoreService.isPartnerAccessingSfdcDeal; else enablePa">
                                <span class="listing-icon i-vNext-discount" style="font-size: 15px;"></span>
                                {{'common.OTD' | localizationPipe : localizationService.localizedkeySet.size}}
                            </a>
                            <ng-template #enablePa> 
                                <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_OTD}}" attr.action-id="{{dataIdConstantsService.pe_link_openPurchaseAdj}}" (click)='openPurchaseAdj()' >	
                                    <span class="listing-icon i-vNext-discount" style="font-size: 15px;"></span>
                                {{'common.OTD' | localizationPipe : localizationService.localizedkeySet.size}}	
                                </a>
                            </ng-template>
                        </li>
                        <li *ngIf="priceEstimateStoreService.selectedEnrollment?.displayQnA" >	
                            <a href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_openQnAFlyout}}" (click)="openQnAFlyout(priceEstimateStoreService.selectedEnrollment);" *ngIf="!priceEstimateStoreService.viewAllSelected && proposalStoreService.proposalEditAccess; else disableQna">
                                <ng-container *ngIf="priceEstimateStoreService.selectedEnrollment?.id === 6">
                                    <span class="listing-icon i-vNext-edit-filled"></span>
                                    {{'price-estimation.EDIT_PORTFOLIO_SETUP' | localizationPipe : localizationService.localizedkeySet.size}}
                                </ng-container>
                                <ng-container *ngIf="priceEstimateStoreService.selectedEnrollment?.id === 3">
                                    <span class="listing-icon i-vNext-questionnaire"></span>
                                    {{'price-estimation.QUESTIONNAIRE' | localizationPipe : localizationService.localizedkeySet.size}}
                                </ng-container>
                            </a>
                            <ng-template #disableQna> 
                                <a href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_openQnAFlyoutdisabled}}" [ngClass]="{'disabled': true}">	
                                    <span class="listing-icon i-vNext-questionnaire"></span>
                                    {{'price-estimation.QUESTIONNAIRE' | localizationPipe : localizationService.localizedkeySet.size}}	
                                </a>
                            </ng-template>	
                        </li>
                        <li *ngIf='proposalStoreService.allowUpdatePA || (selectedEnrollmentArray.length && proposalStoreService.isSellerAllowUpdateOTA && !isUpgradeFlow)'>
                            <a href="javascript:void(0);" id="{{elementIdConstantsService.PE_UPDATE_OTD}}" attr.action-id="{{dataIdConstantsService.pe_link_openUpdatePurchaseA}}" (click)='openUpdatePurchaseA()' [ngClass]="{'disabled': priceEstimateStoreService.viewAllSelected}">
                                {{'common.UPDATE_OTD' | localizationPipe : localizationService.localizedkeySet.size}} 
                            </a>
                        </li>

                        <!-- Updated section for IB when flag is on -->
                        <ng-container *ngIf="!eaStoreService.isValidationUI && isDnxSuiteAdded && eaService.features.IB_OPTIMIZATION">
                            <li *ngIf="!priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate" class="position-relative">
                                <button class="position-relative btn btn-secondary re-processIb" (click)="callIbReprocessOptimization(false, 'initiateIb')" *ngIf="proposalStoreService.proposalData?.syncStatus?.cxEditFlag && !(proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned) && !proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag && !priceEstimateStoreService.viewAllSelected && !proposalStoreService.isReadOnly && !proposalStoreService.proposalData?.cxBillToWipedOff; else disableInitiateIbButton" attr.action-id="{{dataIdConstantsService.servicesGrid_button_initiateIb}}">
                                    <span class="eaicon-scan mr-1"></span>{{'common.INITATE_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}
                                </button>
                                <ng-template #disableInitiateIbButton>
                                    <button class="position-relative btn btn-secondary re-processIb disabled" #initIbDisableMsgTooltip="ngbTooltip" [ngbTooltip]="!priceEstimateStoreService.viewAllSelected ? initIbDisableTooltip : ''" container="body" placement="top-right" attr.action-id="{{dataIdConstantsService.servicesGrid_button_initiateIb_disabled}}">
                                        <span class="eaicon-scan disabled mr-1"></span>{{'common.INITATE_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}
                                    </button>
                                    <ng-template #initIbDisableTooltip>
                                        {{'price-estimation.associated-services-grid.INITIATE_IB_INPROGRESS_TOOLTIP_MSG' | localizationPipe : localizationService.localizedkeySet.size}}
                                    </ng-template>
                                </ng-template>
                            </li>
            
                            <li *ngIf="!priceEstimateStoreService.selectedCxEnrollment?.discountCascadePending && priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate && !proposalStoreService.proposalData?.syncStatus?.cxEditFlag && (!proposalStoreService.proposalData?.syncStatus?.ibAssessmentLastState || (proposalStoreService.proposalData?.syncStatus?.ibAssessmentLastState === 'repullIb'))" class="position-relative">
                                <button class="position-relative btn btn-secondary re-processIb disabled" *ngIf="!(priceEstimateStoreService.selectedCxEnrollment?.hardwareLinePricesInSync || priceEstimateStoreService.selectedCxEnrollment?.discountCascadePending) || priceEstimateStoreService.viewAllSelected || priceEstimateStoreService.selectedCxEnrollment?.cxSoftwareSupportOnly || proposalStoreService.isReadOnly || (eaService.isUpgradeFlow && !priceEstimateStoreService.selectedCxEnrollment?.ibAssementRequiredForCxUpgradeType) || (proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned) || !checkIfLastRepullPassed24Hrs() || proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag || proposalStoreService.proposalData?.cxBillToWipedOff; else enableReprocesIbAssessmentForRel"  #reprocessIbDisableMsgTooltip="ngbTooltip" [ngbTooltip]="reprocessIbDisableTooltip" container="body" placement="top-right" attr.action-id="{{dataIdConstantsService.servicesGrid_button_reprocessIb_disabled}}">
                                    <span class="eaicon-scan disabled mr-1"></span>{{'price-estimation.associated-services-grid.REPROCESS_IB_ASSESSMENT_NEW' | localizationPipe : localizationService.localizedkeySet.size}}
                                </button>
                                <ng-template #reprocessIbDisableTooltip>
                                    {{'price-estimation.associated-services-grid.REPROCESS_IB_DISABLED_TOOLTIP_MESSAGE' | localizationPipe : localizationService.localizedkeySet.size}}
                                </ng-template>
                                <ng-template #enableReprocesIbAssessmentForRel>
                                    <button class="position-relative btn btn-secondary re-processIb" (click)="callIbReprocessOptimization(true, 'repullIb')" attr.action-id="{{dataIdConstantsService.servicesGrid_button_reprocessIb}}">
                                        <span class="eaicon-scan mr-1"></span>{{'price-estimation.associated-services-grid.REPROCESS_IB_ASSESSMENT_NEW' | localizationPipe : localizationService.localizedkeySet.size}}
                                    </button>
                                </ng-template>
                            </li>


                            <li *ngIf="priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate && (proposalStoreService.proposalData?.syncStatus?.cxEditFlag || (proposalStoreService.proposalData?.syncStatus?.ibAssessmentLastState && (proposalStoreService.proposalData?.syncStatus?.ibAssessmentLastState === 'updateIb' || proposalStoreService.proposalData?.syncStatus?.ibAssessmentLastState === 'updateAndReprocessIb' )))" class="position-relative">
                                <span class="btn-icon-drp disabled" *ngIf="proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag || !proposalStoreService.proposalData?.syncStatus?.cxEditFlag || priceEstimateStoreService.viewAllSelected || proposalStoreService.isReadOnly || proposalStoreService.proposalData?.cxBillToWipedOff; else enableUpdate">
                                    <span class="eaicon-scan disabled"></span>
                                    <a href="javascript:void(0)" class="drp-dwn-txt disabled" attr.action-id="{{dataIdConstantsService.servicesGrid_link_updateIb}}">{{'common.UPDATE_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                                    <a href="javascript:void(0)" class="drp-dwn disabled">
                                        <span class="eaicon-arrow-down-fill disabled"></span>
                                    </a>
                                </span>
                                <ng-template #enableUpdate>
                                    <span class="btn-icon-drp">
                                        <span class="eaicon-scan"></span>
                                        <a href="javascript:void(0)" class="drp-dwn-txt" (click)="callIbReprocessOptimization(false, 'updateIb')" attr.action-id="{{dataIdConstantsService.servicesGrid_link_updateIb}}">{{'common.UPDATE_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                                        <a href="javascript:void(0)" class="drp-dwn" (click)="openUpdateIbDropDown()" (clickOutside)="closeUpdateIbDropDown()">
                                            <span class="eaicon-arrow-down-fill"></span>
                                            <ul *ngIf="openUpdateIbDrop" [class.show]="openUpdateIbDrop">
                                                <li>
                                                    <a href="javascript:void(0)" (click)="callIbReprocessOptimization(true, 'updateAndReprocessIb')" [ngClass]="{'disabled': !checkIfLastRepullPassed24Hrs()}" attr.action-id="{{dataIdConstantsService.servicesGrid_link_updateRprocessIb}}">{{'price-estimation.associated-services-grid.UPDATE_AND_REPROCESS_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}</a>
                                                </li>
                                            </ul>
                                        </a>
                                    </span>
                                </ng-template>
                                  <!-- <span class="i-vNext-help-filled ml-2 cursor-pointer"  #tooltip="ngbTooltip" [ngbTooltip]="updateIbTooltip" placement='top-right'></span>
                                  <ng-template #updateIbTooltip>
                                    <span>
                                        <b>{{'common.UPDATE_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}</b>{{'price-estimation.associated-services-grid.CLICK_UPDATE_IB_TOOLTIP_MSG' | localizationPipe : localizationService.localizedkeySet.size}}
                                    </span><br/><br/><br/>
                                    <span>
                                        <b>{{'price-estimation.associated-services-grid.UPDATE_AND_REPROCESS_IB_ASSESSMENT' | localizationPipe : localizationService.localizedkeySet.size}}</b>{{'price-estimation.associated-services-grid.CLICK_UPDATE_REPROCESS_IB_TOOLTIP_MSG' | localizationPipe : localizationService.localizedkeySet.size}}
                                    </span>
                                </ng-template> -->
                            </li>
                        </ng-container>
                    </ul>
                </div>
            </div>
            <!-- End of Title Row -->


            <div class="row">
               
                <!-- RSD Rules info message -->
                <!-- <div class="col-12" *ngIf="proposalStoreService.displayMaxSubscriptionRsdMsg">
                    <div class="alert alert--info alert-dismissable mb-2 more--actions paddingR255">
                        <span class="icon-msg-Info mr-2"><span class="path1"></span><span class="path2"></span><span
                                class="path3"></span></span>
                        <span>Requested Start Date set to day after after end date of current EA subscription(s)</span>
                    </div>
                </div> -->
                <div class="col-12">
                    <!-- <div *ngIf="priceEstimateStoreService.enableRecalculateAll && !proposalStoreService.isReadOnly" class="alert alert--warning alert-dismissable mb-2">
                        <span class="alert-icon d-flex">
                            <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                        </span>
                        <span>One of the changes that you made requires a recalculation. Click <a (click)='recalculateAll()' style="cursor: pointer;color: #227bb1;"> Recalculate All </a> to update the pricing and save it.</span>
                    </div> -->
                    
                    <!-- <div *ngIf="showConfirmationMessage" class="alert alert--success alert-dismissable mb-2">
                        <span class="alert-icon d-flex">
                            <span class="icon-done1"><span class="path1"></span><span class="path2"></span></span>
                        </span>
                        <span>You have successfully recalculated and saved the changes.</span>
                    </div> -->

           <div class="row" *ngIf = "priceEstimateStoreService.selectedEnrollment?.id === CONST_SERVICE_ENROLLMENT && priceEstimateStoreService.selectedEnrollment?.eamsDelivery?.partnerDeliveryEligible && priceEstimateStoreService.selectedEnrollment?.eamsDelivery?.partnerDeliverySelected" >
   
            <div class="col">

        <div class="alert alert--cx-info eligible mt-2 pr-2" >
           <div class="cx-msg">
               <p class="msg">
                <span class="icon-msg-Info">
                    <span class="path1"></span>
                    <span class="path2"></span>
                    <span class="path3"></span>
                </span>   
                {{'price-estimation.ELIGIBLE_TO_AVAIL_SERVICES' | localizationPipe : localizationService.localizedkeySet.size}} <a href="javascript:void(0);" attr.action-id="{{dataIdConstantsService.pe_link_openEAMS}}" (click)="openEAMS()">{{'common.EAMS_DELIVERY' | localizationPipe : localizationService.localizedkeySet.size}}</a> {{'price-estimation.WISH_TO_SWITCH' | localizationPipe : localizationService.localizedkeySet.size}}
               </p>
           </div>
        </div>
    </div>
</div>  

<div *ngIf="priceEstimateStoreService.selectedEnrollment?.id === CONST_HYBRID_ENROLLMENT && !proposalStoreService.isReadOnly" class="alert alert--info alert-dismissable mb-2 more--actions">
    <span class="icon-msg-Info mr-2"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
    <div class="info-text">
        <span class="d-block w-100">{{'price-estimation.ENTER_WORKER_COUNT_HYBRID_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
    </div>
</div>
<div class="alert alert--info alert-dismissable mb-2 more--actions paddingR255" *ngIf = "priceEstimateStoreService.selectedEnrollment?.suggestedUserCount && !priceEstimateStoreService.viewAllSelected && !proposalStoreService.isReadOnly">
    <span class="icon-msg-Info mr-2"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
    <span>{{'price-estimation.SUGGESTED_USER_COUNT_MSG' | localizationPipe : localizationService.localizedkeySet.size}} {{priceEstimateStoreService.selectedEnrollment?.suggestedUserCount}} </span>
 
  </div>
  
<ng-container *ngIf="!proposalStoreService.proposalData.dealInfo?.subscriptionUpgradeDeal">
    <div class="alert alert--info alert-dismissable mb-2 more--actions paddingR255" *ngIf = "!priceEstimateStoreService.displayCxGrid && !priceEstimateStoreService.viewAllSelected && priceEstimateStoreService.selectedEnrollment?.cxOptInAllowed && !proposalStoreService.isReadOnly && priceEstimateStoreService.selectedEnrollment?.enrolled">
        <span class="icon-msg-Info mr-2"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
        <span>{{'price-estimation.WISH_TO_ADD_SERVICES_FOR_PORTFOLIO' | localizationPipe : localizationService.localizedkeySet.size}}  </span>
    <div class="alert--actions">
        <ul class="inline-listing justify-content-end no-list-style">
        <li><button class="btn btn-primary sm" type="button" attr.action-id="{{dataIdConstantsService.pe_button_addMoreSuites}}" (click) = "addMoreSuites(true)" >Add</button></li>
        </ul>
        </div>
    </div>
    <div *ngIf="priceEstimateStoreService.returnCustomerMsg && !proposalStoreService.isReadOnly && !proposalStoreService.proposalData.dealInfo?.subscriptionUpgradeDeal" class="alert alert--info alert-dismissable mb-2 more--actions">
        <span class="icon-msg-Info mr-2"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
        <div class="info-text">
            <span class="d-block w-100">{{'price-estimation.SUITES_UNAVAILABLE' | localizationPipe : localizationService.localizedkeySet.size}}</span>
        </div>
    </div> 
</ng-container>
<div class="col-12 mb-2 alert alert--info alert-dismissable"  *ngIf="priceEstimateService.isMerakiSuitesPresent">
    <span class="alert-icon">
        <span class="icon-msg-Info"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
    </span>
    <span>{{'common.ENTER_MERAKI_ORG_ID' | localizationPipe : localizationService.localizedkeySet.size}} <a href="javascript:void(0);" (click)="howItWorks()">{{'common.REF_PROGRAM_GUIDE' | localizationPipe : localizationService.localizedkeySet.size}}</a></span>
</div> 
<!-- error message for ib found UNX message -->
<!-- <div class="alert alert--danger alert-dismissable mb-2 more--actions paddingR255" *ngIf = "eaService.features?.WIFI7_REL && eaService.features?.UPFRONT_IBC && !priceEstimateStoreService.viewAllSelected && priceEstimateStoreService.selectedEnrollment?.cxOptInAllowed && !proposalStoreService.isReadOnly && priceEstimateStoreService.selectedEnrollment?.enrolled">
    <span class="icon-msg-error mr-2"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
    <span>{{'price-estimation.CX_SERVICES_MANDATORY_ERROR_MESSAGE' | localizationPipe : localizationService.localizedkeySet.size}}  </span>
<div class="alert--actions">
    <ul class="inline-listing justify-content-end no-list-style">
    <li><button class="btn btn-primary sm" type="button" attr.action-id="{{dataIdConstantsService.pe_button_addMoreSuites}}" (click) = "addMoreSuites(true)" >Add</button></li>
    </ul>
    </div>
</div> -->
 <!-- error message for ib found UNX message -->
  <div >
    <!-- Error List Alert -- Starts Here -->
    <app-multi-error [message] = "proposalStoreService.proposalData.message" > </app-multi-error>
    <!-- Error List Alert Ends Here -->
</div>
<ng-container *ngIf='isDnxSuiteAdded'> 
    <ng-container *ngIf="!eaStoreService.isValidationUI">
        <div class="alert alert--danger alert-dismissable" *ngIf="!priceEstimateStoreService.viewAllSelected && priceEstimateStoreService.selectedCxEnrollment?.hwSupportLinesState === 'QUOTE_CREATION_FAILED' && priceEstimateStoreService.selectedCxEnrollment?.hwSupportReqFailedReason">
            <span class="alert-icon">
                <span class="icon-msg-error"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
            </span>
            <span *ngIf="priceEstimateStoreService.selectedCxEnrollment.hwSupportReqFailedReason !== constantsService.CCWR_ACCESS_ISSUE">{{'price-estimation.associated-services-grid.HW_IB_ERROR_2' | localizationPipe : localizationService.localizedkeySet.size}} <b>{{'price-estimation.associated-services-grid.PRO_TIP' | localizationPipe : localizationService.localizedkeySet.size}}</b> 
                <span *ngIf="priceEstimateStoreService.selectedCxEnrollment.hwSupportReqFailedReason === constantsService.INVALID_BILL_TO_ID"> {{'price-estimation.associated-services-grid.INVALID_BILL_TO_ID' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                <span *ngIf="priceEstimateStoreService.selectedCxEnrollment.hwSupportReqFailedReason === constantsService.INVALID_RESELLER_BILL_TO_ID"> {{'price-estimation.associated-services-grid.INVALID_RESELLER_BILL_TO_ID' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                <span *ngIf="priceEstimateStoreService.selectedCxEnrollment.hwSupportReqFailedReason === constantsService.INVALID_DISTI_BILL_TO_ID"> {{'price-estimation.associated-services-grid.INVALID_DISTI_BILL_TO_ID' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                <span *ngIf="priceEstimateStoreService.selectedCxEnrollment.hwSupportReqFailedReason === constantsService.INVALID_DISTI_RESELLER_BILL_TO_ID"> {{'price-estimation.associated-services-grid.INVALID_DISTI_RESELLER_BILL_TO_ID' | localizationPipe : localizationService.localizedkeySet.size}}</span>
            </span>
            <span *ngIf="priceEstimateStoreService.selectedCxEnrollment.hwSupportReqFailedReason === constantsService.CCWR_ACCESS_ISSUE"> {{'price-estimation.associated-services-grid.VERIFY_YOUR_ACCESS_GET_ACCESS' | localizationPipe : localizationService.localizedkeySet.size}}
                <a href="javascript:void(0);" (click)='goToTroubleShooting()' attr.action-id="{{dataIdConstantsService.servicesGrid_link_goToTroubleShooting}}">{{'price-estimation.associated-services-grid.TROUBLESHOOTING_STEPS' | localizationPipe : localizationService.localizedkeySet.size}}</a>
            </span>
        </div>
        <div class="alert alert--danger alert-dismissable" *ngIf="!priceEstimateStoreService.viewAllSelected && priceEstimateStoreService.selectedCxEnrollment?.hwSupportLinesState === 'QUOTE_CREATION_FAILED' && !priceEstimateStoreService.selectedCxEnrollment?.hwSupportReqFailedReason">
            <span class="alert-icon">
                <span class="icon-msg-error"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
            </span>
            <span>{{'price-estimation.associated-services-grid.TIMEOUT_ERROR' | localizationPipe : localizationService.localizedkeySet.size}} <b>{{'price-estimation.associated-services-grid.PROTIP' | localizationPipe : localizationService.localizedkeySet.size}}</b> {{'price-estimation.associated-services-grid.VERIFY_YOUR_ACCESS' | localizationPipe : localizationService.localizedkeySet.size}} <a href="javascript:void(0);" (click)='goToTroubleShooting()' attr.action-id="{{dataIdConstantsService.servicesGrid_link_goToTroubleShooting}}">{{'price-estimation.associated-services-grid.TROUBLESHOOTING_STEPS' | localizationPipe : localizationService.localizedkeySet.size}}</a></span>
        </div>
        <div class="alert alert--warning alert-dismissable mt-2" *ngIf="(proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned)">  
            <span class="alert-icon d-flex">
                <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
            </span>
            <span class="infoTxt">{{'price-estimation.associated-services-grid.LOCC_NOT_SIGNED_TO_CONFIGURE_CX' | localizationPipe : localizationService.localizedkeySet.size}}</span>
        </div>
        <div *ngIf="!eaService.features.IB_OPTIMIZATION && !priceEstimateStoreService.viewAllSelected && priceEstimateStoreService.showServiceHardwareWarning && !priceEstimateStoreService.selectedCxEnrollment?.lineInError && priceEstimateStoreService.selectedCxEnrollment?.hwSupportLinesState !== 'QUOTE_CREATION_FAILED'" class="alert alert--warning alert-dismissable mb-2">
            <span class="alert-icon d-flex">
            <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
            </span>
           <span>{{'price-estimation.associated-services-grid.HARDWARE_INSTALL_BASE_INPROGRESS_NEW_2' | localizationPipe : localizationService.localizedkeySet.size}}</span>
        </div>
        <!-- new ib inprogress message starts-->
        <ng-container *ngIf="eaService.features.IB_OPTIMIZATION && !priceEstimateStoreService.viewAllSelected && !enrollmentData?.lineInError && enrollmentData?.hwSupportLinesState !== 'QUOTE_CREATION_FAILED'">
            <div class="alert alert--warning alert-dismissable mt-2" *ngIf="proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag">
                <span class="alert-icon d-flex">
                    <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                </span>
                <span class="infoTxt">{{'price-estimation.associated-services-grid.IB_INPROGRESS_MESSAGE' | localizationPipe : localizationService.localizedkeySet.size}}</span>
            </div>
        </ng-container>
       <!-- new ib inprogress message ends-->
        <div class="alert alert--danger alert-dismissable mt-2" *ngIf="eaStoreService.ibRepullFeatureFlag && priceEstimateStoreService.displayIbPullMsg && showIbPullMsg && !(priceEstimateStoreService.showServiceHardwareWarning && !priceEstimateStoreService.selectedCxEnrollment?.lineInError) && (!eaService.features.IB_OPTIMIZATION || (eaService.features.IB_OPTIMIZATION && !proposalStoreService.proposalData?.syncStatus?.cxEditFlag))">  
            <span class="alert-icon">
                <span class="icon-msg-error"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
            </span>
            <span class="infoTxt">{{'price-estimation.associated-services-grid.IB_SYSTEMATIC_REPULL_MSG_PART1' | localizationPipe : localizationService.localizedkeySet.size}}  {{priceEstimateStoreService.diffInDaysForSystematicIbRepull}}  {{'price-estimation.associated-services-grid.IB_SYSTEMATIC_REPULL_MSG_PART2' | localizationPipe : localizationService.localizedkeySet.size}}<a href="javascript:void();" (click)="reProcessIbPull()" attr.action-id="{{dataIdConstantsService.servicesGrid_link_sysytematicIbPull}}" [ngClass]="{'disabled': (proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned) || proposalStoreService.proposalData?.cxBillToWipedOff || proposalStoreService.isReadOnly}">click here </a> {{'price-estimation.associated-services-grid.IB_SYSTEMATIC_REPULL_MSG_PART3_FOR_SW' | localizationPipe : localizationService.localizedkeySet.size}} </span>
            <span class="alert-action"><button type="button" class="icon-close-btn mt-2" (click)="closeIbPullMsg()" attr.action-id="{{dataIdConstantsService.servicesGrid_button_closeIbPullMsg}}"></button></span>
        </div>
        </ng-container>
        <div class="mb-2" *ngIf="eaService.features.IB_OPTIMIZATION && proposalStoreService.proposalData?.syncStatus?.cxEditFlag && !proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag && priceEstimateStoreService.selectedCxEnrollment?.lineInError && !proposalStoreService.isReadOnly && !priceEstimateStoreService.viewAllSelected && !priceEstimateStoreService.selectedCxEnrollment?.cxSoftwareSupportOnly && (!priceEstimateStoreService.displayIbPullMsg || (eaService.isUpgradeFlow && priceEstimateStoreService.selectedCxEnrollment?.ibAssementRequiredForCxUpgradeType))">
            <div class="alert alert--danger alert-dismissable">
                <span class="alert-icon">
                    <span class="icon-msg-error"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                </span>
                <span class="infoTxt">{{'price-estimation.associated-services-grid.HW_ERRORS_PRESENT_AND_REQUIRED_TO_UPDATE_IB' | localizationPipe : localizationService.localizedkeySet.size}}</span>
            </div>
        </div>
        <div class="mb-2" *ngIf="priceEstimateStoreService.selectedCxEnrollment?.lineInError && !proposalStoreService.isReadOnly && !priceEstimateStoreService.viewAllSelected && !priceEstimateStoreService.selectedCxEnrollment?.cxSoftwareSupportOnly && (!priceEstimateStoreService.displayIbPullMsg || (eaService.isUpgradeFlow && priceEstimateStoreService.selectedCxEnrollment?.ibAssementRequiredForCxUpgradeType)) && (!eaService.features.IB_OPTIMIZATION || (eaService.features.IB_OPTIMIZATION && !proposalStoreService.proposalData?.syncStatus?.cxEditFlag && !proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag))">
            <div class="alert alert--danger alert-dismissable">
                <span class="alert-icon">
                    <span class="icon-msg-error"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                </span>
                <span *ngIf="!eaService.features.IB_OPTIMIZATION">{{'price-estimation.associated-services-grid.ERRORS_ON_THE_HARDWARE_INSTALL_BASE_DATA_2' | localizationPipe : localizationService.localizedkeySet.size}} <a href="javascript:void(0);" (click)='viewAndEditHardwareSupport()' attr.action-id="{{dataIdConstantsService.servicesGrid_link_hardwareSupportDetails}}" [ngClass]="{'disabled': (proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned)}">{{'common.HARDWARE_SUPPORT_DETAILS' | localizationPipe : localizationService.localizedkeySet.size}}</a> {{'price-estimation.associated-services-grid.ADDRESS_ERRORS' | localizationPipe : localizationService.localizedkeySet.size}}</span>
                    <span *ngIf="eaService.features.IB_OPTIMIZATION">{{'price-estimation.associated-services-grid.HW_IB_ERRORS_MSG_1' | localizationPipe : localizationService.localizedkeySet.size}} <a href="javascript:void(0);" (click)='viewAndEditHardwareSupport()' attr.action-id="{{dataIdConstantsService.servicesGrid_link_hardwareSupportDetails}}" [ngClass]="{'disabled': (proposalStoreService.isPartnerAccessingSfdcDeal && !vnextStoreService.loccDetail?.loccSigned) || (eaService.features?.PARTNER_SUPER_USER_REL && proposalStoreService.isPartnerAccessingSfdcDeal && (eaStoreService.userInfo?.superUser && eaStoreService.userInfo?.superUser === constantsService.PARTNER_RO_SUPER_USER) )}">{{'common.HARDWARE_SUPPORT_DETAILS' | localizationPipe : localizationService.localizedkeySet.size}}</a> {{'price-estimation.associated-services-grid.HW_IB_ERRORS_MSG_2' | localizationPipe : localizationService.localizedkeySet.size}}</span>
            </div>
        </div>


<div *ngIf="priceEstimateStoreService.hardwareIbSuccess && !eaService.features.IB_OPTIMIZATION" class="alert alert--success alert-dismissable mb-2">
    <span class="alert-icon d-flex">
    <span class="icon-done1"><span class="path1"></span><span class="path2"></span></span>
    </span>
   <span>{{'common.HW_IB_SUCCESS_2' | localizationPipe : localizationService.localizedkeySet.size}}</span>
</div>

<div *ngIf="!priceEstimateStoreService.errorMessagesPresentForCx && priceEstimateStoreService.displaySuccessMsgForPrices && !priceEstimateStoreService.selectedCxEnrollment?.lineInError && !eaService.features.IB_OPTIMIZATION" class="alert alert--success alert-dismissable">
    <span class="alert-icon">
        <span class="icon-done1"><span class="path1"></span><span class="path2"></span></span>
    </span>
    <span>{{'price-estimation.associated-services-grid.SERVICES_SUCCESSFULLY_PRICED' | localizationPipe : localizationService.localizedkeySet.size}}</span>
</div>

<!-- new ib messages start -->
<div *ngIf="eaService.features.IB_OPTIMIZATION && proposalStoreService.proposalData?.syncStatus?.showIbAssessmentButton && !proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag && priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate && !priceEstimateStoreService.selectedCxEnrollment?.lineInError && !priceEstimateStoreService.errorMessagesPresentForCx" class="alert alert--success alert-dismissable mb-2">
    <span class="alert-icon d-flex">
    <span class="icon-done1"><span class="path1"></span><span class="path2"></span></span>
    </span>
   <span>{{'price-estimation.associated-services-grid.IB_ASSESSMENT_SUCCESS_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
</div>

<div class="alert alert--warning alert-dismissable mt-2" *ngIf="eaService.features.IB_OPTIMIZATION && proposalStoreService.proposalData?.syncStatus?.cxEditFlag && !proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag && !priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate && enrollmentData?.hwSupportLinesState !== 'QUOTE_CREATION_FAILED'">  
    <span class="alert-icon d-flex">
        <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
    </span>
    <span class="infoTxt">{{'price-estimation.associated-services-grid.COMPLETE_CHANGES_PRIOR_TO_INITIATE_IB_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
</div>

<div class="alert alert--warning alert-dismissable mt-2" *ngIf="eaService.features.IB_OPTIMIZATION && proposalStoreService.proposalData?.syncStatus?.cxEditFlag && !proposalStoreService.proposalData?.syncStatus?.cxCcwrRipFlag && priceEstimateStoreService.selectedCxEnrollment?.hwLastIbPulledAtDate && enrollmentData?.hwSupportLinesState !== 'QUOTE_CREATION_FAILED'">  
    <span class="alert-icon d-flex">
        <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
    </span>
    <span class="infoTxt">{{'price-estimation.associated-services-grid.COMPLETE_CHANGES_PRIOR_TO_UPDATE_IB_MSG' | localizationPipe : localizationService.localizedkeySet.size}}</span>
</div>
<!-- new ib messages end -->
</ng-container>
    <div *ngIf="showServiceHardwareWarning" class="alert alert--warning alert-dismissable mb-2">
            <span class="alert-icon d-flex">
            <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
            </span>
           <span>{{'price-estimation.RETRIEVING_HARDWARE_IB_2' | localizationPipe : localizationService.localizedkeySet.size}}</span>
    </div>

                            
    <div *ngIf="showServiceSuccessMessage" class="alert alert--success alert-dismissable mb-2">
            <span class="alert-icon d-flex">
            <span class="icon-done1"><span class="path1"></span><span class="path2"></span></span>
            </span>
            <span>{{'price-estimation.SERVICES_SUCCESSFULLY_PRICED' | localizationPipe : localizationService.localizedkeySet.size}}</span>
    </div>


                </div>
            </div>
    
            <div class="row">
                <div class="col-12 mb-3" attr.action-id="{{dataIdConstantsService.pe_link_inItGrid}}" (click) = "inItGrid()">
                    <ag-grid-angular #agGrid id="ag-grid" style="width: 100%;" class="ag-fresh vNext header-expandCollapse mt-0" (gridReady)="onGridReady($event)" [gridOptions]="gridOptions" (click)="onHeaderClick($event)" [getNodeChildDetails]="getNodeChildDetails" (cellClicked)="onCellClicked($event)" (cellMouseOver)="onCellMouseOver($event)" (cellMouseOut)="onCellMouseOut($event)" (rowSelected)="onRowSelected($event)" [columnDefs]="columnDefs" [rowData]="rowData" [sideBar]="false" [groupSelectsChildren]="true" toolPanelSuppressGroups toolPanelSuppressValues debug rowHeight="40" [suppressRowClickSelection]="true">
                    </ag-grid-angular>  
                    <app-associated-services-grid (invokePollerServiceForSwOnly)='invokePollerServiceForSwOnly($event)' *ngIf="priceEstimateStoreService.displayCxGrid"></app-associated-services-grid>
                </div>
            </div>
        </ng-container>

        <!-- show info message if enrollments are not selected -->
        <ng-container *ngIf='!selectedEnrollmentArray.length'> 
            <!--div class="alert alert--warning alert-dismissable">

                <span class="alert-icon">
                    <span class="icon-warning1"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span>
                </span>
                <span>Please make Enrollment selection(s) above</span>
                <a class="close" style="cursor: pointer;" (click)="removeAlert(message)">&times;</a>
            </div-->

            <div class="d-flex w-100 align-items-center justify-content-center empty-enrollment flex-column">
                <img src="../../../../assets/images/icons/empty-enrollment.svg">
                <h4 class="heading--h4">{{'price-estimation.SELECT_PORTFOLIO_FROM_ABOVE' | localizationPipe : localizationService.localizedkeySet.size}}</h4>
            </div>
        </ng-container>
    </div>
</section>
</ng-container>

<app-adjust-desired-qty [poolArray] = "poolArray" [selectedPool]='selectedPool' [selectedAto]='selectedAto' (onClose)='closeDesiredQtyPopup($event)'  *ngIf="priceEstimateService.showDesriredQty"></app-adjust-desired-qty>
<app-purchase-adjustment-break-up *ngIf="priceEstimateService.showPurchaseAdjustmentBreakUp" [selectedEnrollemnt]='priceEstimateStoreService.selectedEnrollment' [column]="breakupColumn"></app-purchase-adjustment-break-up>
<app-benefits-wizard *ngIf="priceEstimateService.showBenefits"></app-benefits-wizard>
<!-- <app-questionnaire *ngIf="priceEstimateService.displayQuestionnaire" [questions]="questionsArray" (qnaSubmitEvent)="enrollmentSelectionAfterQnA()"></app-questionnaire> -->
<app-edit-enrollment *ngIf="priceEstimateService.showEnrollments" [selectedEnrollemnt] = "updateEnrollemntBillingDetails" (closeEditEnrollment)='enrollmentDetailsUpdated($event)' [isChangeSubFlow]="isChangeSubFlow" ></app-edit-enrollment>
<app-manage-purchase-adjustment [poolArray] = "poolArray" *ngIf="priceEstimateService.showPurchaseAdj && !priceEstimateService.paForCollab"></app-manage-purchase-adjustment>
<app-manage-collab-purchase-adjustment [poolArray] = "poolArray" [selectedEnrollemnt] = "priceEstimateStoreService.selectedEnrollment" *ngIf="priceEstimateService.showPurchaseAdj && priceEstimateService.paForCollab"></app-manage-collab-purchase-adjustment>
<app-edit-proposal-parameters (onClose)='closeEditProposalParam($event)' *ngIf="proposalStoreService.editProposalParamter" [isChangeSubFlow]="isChangeSubFlow"></app-edit-proposal-parameters>
<app-update-purchase-adjustment [selectedEnrollemnt] = "priceEstimateStoreService.selectedEnrollment"  *ngIf="priceEstimateService.showUpdatePA"></app-update-purchase-adjustment>
<app-total-contract-value-break-up [selectedEnrollemnt]='priceEstimateStoreService.selectedEnrollment' *ngIf='priceEstimateService.showTcvBreakUp'></app-total-contract-value-break-up>
<app-add-suites *ngIf="priceEstimateStoreService.openAddSuites" [enrollment] = 'enrollmentForAddSuite' [deeplinkForCx]="deeplinkForServices" [deeplinkForSw] = 'deeplinkForSw' (closeAddSuitesEvent)="closeAddSuitesEventUpdated($event)"  [isChangeSubFlow]="isChangeSubFlow" [isUpgradeFlow]="isUpgradeFlow"></app-add-suites>
<!--<app-define-suites *ngIf="priceEstimateStoreService.openAddSuites" [enrollment] = 'enrollmentForAddSuite' [deeplinkForCx]="deeplinkForServices" [deeplinkForSw] = 'deeplinkForSw' (closeAddSuitesEvent)="closeAddSuitesEventUpdated($event)"  [isChangeSubFlow]="isChangeSubFlow" [isUpgradeFlow]="isUpgradeFlow"></app-define-suites>-->
<app-strategic-offer *ngIf="priceEstimateStoreService.showStrategicOffers && eaService.features.STO_REL" (onClose)="closeStrategicOffer($event)"></app-strategic-offer>